[env:esp32-s3-dev]
platform = espressif32
board = esp32-s3-devkitc-1
framework = espidf
monitor_speed = 115200

board_build.cmake_extra_args =
    -DSDKCONFIG_DEFAULTS=sdkconfig.esp32-s3-dev

board_build.partitions = partitions.csv

upload_protocol = esptool
upload_port = /dev/ttyACM0

; OTA upload configuration
; To upload via OTA: pio run -t upload --upload-port ots-fw-main.local
; Or via IP: pio run -t upload --upload-port 192.168.x.x
;upload_flags = 
;    --port=3232
;    --host_port=3232

; ============================================
; Hardware Test Environments
; ============================================
; Each test replaces main.c with a standalone test file.
; Tests run continuously, outputting to serial.
; 
; Usage: pio run -e test-i2c -t upload && pio device monitor

[env:test-i2c]
platform = espressif32
board = esp32-s3-devkitc-1
framework = espidf
monitor_speed = 115200
board_build.cmake_extra_args = -DSDKCONFIG_DEFAULTS=sdkconfig.esp32-s3-dev
board_build.partitions = partitions.csv
build_src_filter = 
    +<*>
    -<main.c>
    +<tests/test_i2c_scan.c>

[env:test-outputs]
platform = espressif32
board = esp32-s3-devkitc-1
framework = espidf
monitor_speed = 115200
board_build.cmake_extra_args = -DSDKCONFIG_DEFAULTS=sdkconfig.esp32-s3-dev
board_build.partitions = partitions.csv
build_src_filter = 
    +<*>
    -<main.c>
    +<tests/test_output_board.c>

[env:test-inputs]
platform = espressif32
board = esp32-s3-devkitc-1
framework = espidf
monitor_speed = 115200
board_build.cmake_extra_args = -DSDKCONFIG_DEFAULTS=sdkconfig.esp32-s3-dev
board_build.partitions = partitions.csv
build_src_filter = 
    +<*>
    -<main.c>
    +<tests/test_input_board.c>

[env:test-adc]
platform = espressif32
board = esp32-s3-devkitc-1
framework = espidf
monitor_speed = 115200
board_build.cmake_extra_args = -DSDKCONFIG_DEFAULTS=sdkconfig.esp32-s3-dev
board_build.partitions = partitions.csv
build_src_filter = 
    +<*>
    -<main.c>
    +<tests/test_adc.c>

[env:test-lcd]
platform = espressif32
board = esp32-s3-devkitc-1
framework = espidf
monitor_speed = 115200
board_build.cmake_extra_args = -DSDKCONFIG_DEFAULTS=sdkconfig.esp32-s3-dev
board_build.partitions = partitions.csv
build_src_filter = 
    +<*>
    -<main.c>
    +<tests/test_lcd.c>

[env:test-websocket]
platform = espressif32
board = esp32-s3-devkitc-1
framework = espidf
monitor_speed = 115200
board_build.cmake_extra_args = -DSDKCONFIG_DEFAULTS=sdkconfig.esp32-s3-dev
board_build.partitions = partitions.csv
; Build all source files - no filter restrictions
build_flags = 
    -Wl,-Map,output.map
    -DTEST_WEBSOCKET
extra_scripts = 
    pre:pre_build_test.py
    post:post_build_test.py

