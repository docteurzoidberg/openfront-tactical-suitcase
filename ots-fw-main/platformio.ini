[env:esp32-s3-dev]
platform = espressif32
board = esp32-s3-devkitc1-n16r8
framework = espidf
monitor_speed = 115200
upload_speed = 921600
extra_scripts =
    pre:tools/pio_embed_webapp.py
    post:tools/pio_upload_factory.py

build_flags =
    -DLCD_I2C_SPEED_HZ=50000
    -DLCD_BACKLIGHT_ACTIVE_LOW=0
    -DWS_SERVER_PORT=443

board_build.cmake_extra_args =
    -DSDKCONFIG_DEFAULTS=sdkconfig.esp32-s3-dev

board_build.partitions = partitions.csv

; Serial upload (default)
upload_protocol = esptool
upload_port = /dev/ttyACM0

; ============================================
; Hardware Test Environments
; ============================================
; Each test replaces main.c with a standalone test file.
; Tests run continuously, outputting to serial.
; 
; Usage: pio run -e test-i2c -t upload && pio device monitor

[env:test-i2c]
platform = espressif32
board = esp32-s3-devkitc1-n16r8
framework = espidf
monitor_speed = 115200
upload_speed = 921600
extra_scripts =
    pre:tools/pio_embed_webapp.py
    post:tools/pio_upload_factory.py
board_build.cmake_extra_args = -DSDKCONFIG_DEFAULTS=sdkconfig.test-i2c
board_build.partitions = partitions.csv
build_flags =
    -DTEST_I2C

[env:test-outputs]
platform = espressif32
board = esp32-s3-devkitc1-n16r8
framework = espidf
monitor_speed = 115200
upload_speed = 921600
extra_scripts =
    pre:tools/pio_embed_webapp.py
    post:tools/pio_upload_factory.py
board_build.cmake_extra_args = -DSDKCONFIG_DEFAULTS=sdkconfig.test-outputs
board_build.partitions = partitions.csv
build_flags =
    -DTEST_OUTPUTS

[env:test-inputs]
platform = espressif32
board = esp32-s3-devkitc1-n16r8
framework = espidf
monitor_speed = 115200
upload_speed = 921600
extra_scripts =
    pre:tools/pio_embed_webapp.py
    post:tools/pio_upload_factory.py
board_build.cmake_extra_args = -DSDKCONFIG_DEFAULTS=sdkconfig.test-inputs
board_build.partitions = partitions.csv
build_flags =
    -DTEST_INPUTS

[env:test-adc]
platform = espressif32
board = esp32-s3-devkitc1-n16r8
framework = espidf
monitor_speed = 115200
upload_speed = 921600
extra_scripts =
    pre:tools/pio_embed_webapp.py
    post:tools/pio_upload_factory.py
board_build.cmake_extra_args = -DSDKCONFIG_DEFAULTS=sdkconfig.test-adc
board_build.partitions = partitions.csv
build_flags =
    -DTEST_ADC

[env:test-lcd]
platform = espressif32
board = esp32-s3-devkitc1-n16r8
framework = espidf
monitor_speed = 115200
upload_speed = 921600
extra_scripts =
    pre:tools/pio_embed_webapp.py
    post:tools/pio_upload_factory.py
board_build.cmake_extra_args = -DSDKCONFIG_DEFAULTS=sdkconfig.test-lcd
board_build.partitions = partitions.csv
build_flags =
    -DTEST_LCD
    -DLCD_BACKLIGHT_ACTIVE_LOW=0

[env:test-websocket]
platform = espressif32
board = esp32-s3-devkitc1-n16r8
framework = espidf
monitor_speed = 115200
upload_speed = 921600
extra_scripts =
    pre:tools/pio_embed_webapp.py
    post:tools/pio_upload_factory.py
board_build.cmake_extra_args = -DSDKCONFIG_DEFAULTS=sdkconfig.test-websocket
board_build.partitions = partitions.csv
build_flags =
    -DTEST_WEBSOCKET
    -DWS_SERVER_PORT=443
